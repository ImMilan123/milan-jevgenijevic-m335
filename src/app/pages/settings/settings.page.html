<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/dashboard"></ion-back-button>
    </ion-buttons>
    <ion-title>
      <span (click)="goHome()" style="cursor: pointer; user-select: none;">ðŸ’° BudgetBuddy</span>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="settings-container">
    <!-- Theme Settings -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="moon"></ion-icon>
          Theme
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item lines="none">
          <ion-icon name="moon" slot="start"></ion-icon>
          <ion-label>Dark Mode</ion-label>
          <ion-toggle 
            [(ngModel)]="darkMode" 
            (ionChange)="toggleDarkMode($event)"
            slot="end">
          </ion-toggle>
        </ion-item>
      </ion-card-content>
    </ion-card>

    <!-- Network Status -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="wifi"></ion-icon>
          Network Status
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item lines="none">
          <ion-icon name="wifi" slot="start"></ion-icon>
          <ion-label>Connection Status</ion-label>
          <ion-badge [color]="isOnline ? 'success' : 'danger'" slot="end">
            {{ isOnline ? 'Online' : 'Offline' }}
          </ion-badge>
        </ion-item>
        <p class="info-text">
          {{ isOnline 
            ? 'Connected to the internet. All changes will sync automatically.' 
            : 'Offline mode. Changes will be saved locally and synced when you reconnect.' }}
        </p>
      </ion-card-content>
    </ion-card>

    <!-- App Information -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="information-circle"></ion-icon>
          App Information
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item lines="none">
          <ion-label>
            <h3>BudgetBuddy</h3>
            <p>Mini Finanztracker</p>
          </ion-label>
        </ion-item>
        <ion-item lines="none">
          <ion-label>
            <p>Version</p>
            <h3>{{ appVersion }}</h3>
          </ion-label>
        </ion-item>
        <ion-item lines="none">
          <ion-label>
            <p>Created for</p>
            <h3>Modul 335</h3>
          </ion-label>
        </ion-item>
      </ion-card-content>
    </ion-card>

    <!-- Supabase Connection Test -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>Supabase Connection</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-button expand="block" (click)="testSupabaseConnection()" color="primary">
          Test Supabase Connection
        </ion-button>
        <p class="info-text" [style.color]="supabaseConnected ? 'var(--ion-color-success)' : 'var(--ion-color-medium)'">
          Status: {{ supabaseStatus }}
        </p>
      </ion-card-content>
    </ion-card>

    <!-- Data Management -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>Data Management</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-button expand="block" (click)="clearCache()" fill="outline" color="danger">
          Clear Offline Cache
        </ion-button>
        <p class="info-text">
          This will only clear the offline cache. Your online data in Supabase will not be affected.
        </p>
      </ion-card-content>
    </ion-card>

    <!-- Device Features Info -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>Device Features Used</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="feature-list">
          <div class="feature-item">
            <ion-icon name="camera"></ion-icon>
            <span>Camera (Receipt photos)</span>
          </div>
          <div class="feature-item">
            <ion-icon name="wifi"></ion-icon>
            <span>Network Status</span>
          </div>
          <div class="feature-item">
            <ion-icon name="save"></ion-icon>
            <span>Local Storage (Offline cache)</span>
          </div>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>

